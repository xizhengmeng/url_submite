# Submit Sitemap - URLæ‰¹é‡æäº¤å·¥å…·

ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„URLæäº¤å·¥å…·ï¼Œå¯ä»¥ä»ç½‘ç«™sitemapè·å–URLå¹¶æ‰¹é‡æäº¤åˆ°ç™¾åº¦ã€Bingå’ŒGoogleæœç´¢å¼•æ“ã€‚

## âœ¨ ç‰¹æ€§

- ğŸŒ **å¤šç«™ç‚¹æ”¯æŒ** - åŒæ—¶ç®¡ç†å¤šä¸ªç½‘ç«™çš„URLæäº¤
- ğŸ”„ **è‡ªåŠ¨å»é‡** - è‡ªåŠ¨è®°å½•å·²æäº¤çš„URLï¼Œé¿å…é‡å¤æäº¤
- ğŸ“Š **é…é¢ç®¡ç†** - ä¸ºæ¯ä¸ªå¹³å°å•ç‹¬é…ç½®æ¯æ—¥æäº¤é…é¢
- ğŸ“¦ **Sitemapè§£æ** - è‡ªåŠ¨è§£æsitemap.xmlï¼ˆåŒ…æ‹¬ç´¢å¼•æ–‡ä»¶å’Œå‹ç¼©æ–‡ä»¶ï¼‰
- ğŸ’¾ **å†å²è®°å½•** - æœ¬åœ°ä¿å­˜æäº¤å†å²ï¼Œæ”¯æŒå¢é‡æäº¤
- ğŸ“ˆ **å®æ—¶è¿›åº¦æ¡** - ç›´è§‚æ˜¾ç¤ºsitemapè§£æå’ŒURLæäº¤è¿›åº¦
- ğŸ“ **è¯¦ç»†æ—¥å¿—** - è‡ªåŠ¨è®°å½•æ¯æ¬¡æäº¤çš„è¯¦ç»†ä¿¡æ¯åˆ°æ—¥å¿—æ–‡ä»¶
- ğŸš€ **ç®€å•æ˜“ç”¨** - æ¯å¤©åªéœ€è¿è¡Œä¸€æ¬¡å‘½ä»¤

## ğŸ“‹ æ”¯æŒçš„æœç´¢å¼•æ“

| æœç´¢å¼•æ“ | APIç±»å‹ | è¯´æ˜ |
|---------|--------|------|
| ç™¾åº¦ | ç™¾åº¦ç«™é•¿å¹³å°API | éœ€è¦åœ¨ç™¾åº¦ç«™é•¿å¹³å°è·å–token |
| Bing | IndexNowåè®® | å¿«é€Ÿã€å…è´¹çš„å®æ—¶ç´¢å¼•åè®® |
| Google | IndexNowåè®® | ä¿ç•™æ¥å£ï¼Œå¾…Googleæ”¯æŒ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æ„å»ºç¨‹åº

**ä½¿ç”¨ Makefileï¼ˆæ¨èï¼‰**

```bash
# æ„å»ºæ‰€æœ‰ macOS ç‰ˆæœ¬
make

# æˆ–è€…
make build
```

**å¿«é€Ÿæ„å»ºï¼š**
```bash
# ä»…æ„å»ºå½“å‰å¹³å°
make quick

# æ¸…ç†åé‡æ–°æ„å»º
make clean && make

# æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤
make help
```

**æ„å»ºç»“æœï¼š**
```
dist/
â”œâ”€â”€ submit                  # é€šç”¨ç‰ˆæœ¬
â””â”€â”€ submit-darwin-arm64     # Apple Silicon ç‰ˆæœ¬
```

**å…¶ä»–å¹³å°ï¼š**
```bash
# æ„å»ºæ‰€æœ‰å¹³å°ç‰ˆæœ¬ï¼ˆmacOS/Linux/Windowsï¼‰
make build-all
```

### 2. é¦–æ¬¡è¿è¡Œ

ç¨‹åºé¦–æ¬¡è¿è¡Œæ—¶ä¼šè‡ªåŠ¨åœ¨ç”¨æˆ·ä¸»ç›®å½•åˆ›å»ºé…ç½®ï¼š

```bash
# é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨åˆå§‹åŒ–
./submit test

# æˆ–è€…ä»»ä½•å‘½ä»¤éƒ½ä¼šè§¦å‘åˆå§‹åŒ–
./submit run
```

ç¨‹åºä¼šåœ¨ `~/.submit/` åˆ›å»ºä»¥ä¸‹ç›®å½•ç»“æ„ï¼š
```
~/.submit/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ sites/
â”‚       â””â”€â”€ _template/
â”‚           â””â”€â”€ site.yaml.example
â””â”€â”€ data/
    â”œâ”€â”€ logs/
    â””â”€â”€ submitted/
```

### 3. é…ç½®ç½‘ç«™

åˆ›å»ºä½ çš„ç½‘ç«™é…ç½®ï¼š

```bash
# è¿›å…¥é…ç½®ç›®å½•
cd ~/.submit/config/sites

# åˆ›å»ºç½‘ç«™é…ç½®ç›®å½•
mkdir example.com

# å¤åˆ¶æ¨¡æ¿
cp _template/site.yaml.example example.com/site.yaml

# ç¼–è¾‘é…ç½®
vim example.com/site.yaml
```

é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼š

```yaml
name: "æˆ‘çš„ç½‘ç«™"
domain: example.com
sitemap_url: "https://example.com/sitemap.xml"

quotas:
  baidu: 100   # æ¯å¤©æäº¤100æ¡åˆ°ç™¾åº¦
  bing: 200    # æ¯å¤©æäº¤200æ¡åˆ°Bing
  google: 150  # æ¯å¤©æäº¤150æ¡åˆ°Google

api:
  baidu:
    token: "your-baidu-token"
    site: "https://example.com"

  bing:
    api_key: "your-indexnow-key"
    host: "example.com"
    key_location: "https://example.com/your-key.txt"

  google:
    api_key: "your-indexnow-key"
    host: "example.com"
    key_location: "https://example.com/your-key.txt"

settings:
  sitemap_cache_hours: 168
  timeout: 30
  concurrent: 3
  log_level: info
```

> **æ³¨æ„**ï¼š
> - æ¯ä¸ªç½‘ç«™ä½¿ç”¨ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶
> - é…ç½®æ–‡ä»¶ä½äºï¼š`~/.submit/config/sites/`
> - ç¨‹åºä¼šè‡ªåŠ¨éå†è¯¥ç›®å½•ä¸‹æ‰€æœ‰ `.yaml` æ–‡ä»¶
> - æ—¥å¿—æ–‡ä»¶ä½äºï¼š`~/.submit/data/logs/`
> - å†å²è®°å½•ä½äºï¼š`~/.submit/data/submitted/`

### 4. è¿è¡Œ

```bash
# è¿è¡Œæäº¤ä»»åŠ¡
./submit run

# è¯¦ç»†æ¨¡å¼
./submit run -v

# æŸ¥çœ‹ç»Ÿè®¡
./submit stats

# æµ‹è¯•é…ç½®
./submit test
```

**æŸ¥çœ‹æ—¥å¿—ï¼š**
```bash
# æŸ¥çœ‹ä»Šå¤©çš„æ—¥å¿—
cat ~/.submit/data/logs/$(date +%Y-%m-%d).log

# å®æ—¶ç›‘æ§
tail -f ~/.submit/data/logs/$(date +%Y-%m-%d).log
```

## ğŸ“– ä½¿ç”¨è¯´æ˜

### åŸºæœ¬å‘½ä»¤

```bash
# è¿è¡Œæäº¤ä»»åŠ¡ï¼ˆåŸºæœ¬æ¨¡å¼ï¼‰
./dist/submit run

# è¯¦ç»†è¾“å‡ºæ¨¡å¼ï¼ˆåŒæ—¶æ˜¾ç¤ºæ—¥å¿—åˆ°æ§åˆ¶å°ï¼‰
./dist/submit run -v

# æŸ¥çœ‹æäº¤ç»Ÿè®¡
./dist/submit stats

# æµ‹è¯•é…ç½®æ–‡ä»¶
./dist/submit test

# æ¸…é™¤æŒ‡å®šç«™ç‚¹çš„å†å²è®°å½•
./dist/submit reset example.com

# æ˜¾ç¤ºå¸®åŠ©
./dist/submit help
```

### é«˜çº§é€‰é¡¹

```bash
# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®ç›®å½•
./dist/submit run -c /path/to/config/sites

# è¯¦ç»†è¾“å‡ºæ¨¡å¼ + è‡ªå®šä¹‰é…ç½®
./dist/submit run -v -c /path/to/config/sites
```

### é…ç½®ç›®å½•

ç¨‹åºä½¿ç”¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„ `.submit` æ–‡ä»¶å¤¹å­˜å‚¨æ‰€æœ‰é…ç½®å’Œæ•°æ®ï¼š

```
~/.submit/
â”œâ”€â”€ config/sites/          # é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ _template/         # æ¨¡æ¿æ–‡ä»¶
â”‚   â”œâ”€â”€ site1.com/        # ç½‘ç«™1é…ç½®
â”‚   â””â”€â”€ site2.com/        # ç½‘ç«™2é…ç½®
â””â”€â”€ data/
    â”œâ”€â”€ logs/             # æ—¥å¿—æ–‡ä»¶
    â””â”€â”€ submitted/        # æäº¤å†å²
```

**è‡ªå®šä¹‰é…ç½®ç›®å½•ï¼š**
```bash
# ä½¿ç”¨è‡ªå®šä¹‰ä½ç½®
./submit run -c /path/to/config/sites
```

**è¿ç§»ç°æœ‰é…ç½®ï¼š**
```bash
# å¦‚æœä½ ä¹‹å‰ä½¿ç”¨é¡¹ç›®ç›®å½•ä¸‹çš„é…ç½®
cp -r config/sites/* ~/.submit/config/sites/
```

### æ—¥å¿—æ–‡ä»¶

æ‰€æœ‰è¿è¡Œè®°å½•éƒ½ä¼šè‡ªåŠ¨ä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶ï¼š

- **ä½ç½®**: `data/logs/YYYY-MM-DD.log`
- **æ ¼å¼**: å¸¦æ—¶é—´æˆ³çš„è¯¦ç»†æ—¥å¿—
- **å†…å®¹**: åŒ…æ‹¬é…ç½®åŠ è½½ã€sitemapè§£æã€URLè¿‡æ»¤ã€æäº¤ç»“æœç­‰

ç¤ºä¾‹æ—¥å¿—å†…å®¹ï¼š
```
2026/01/23 15:30:00 [INFO] ========== æäº¤ä»»åŠ¡å¼€å§‹ ==========
2026/01/23 15:30:00 [INFO] é…ç½®åŠ è½½å®Œæˆ - æ–‡ä»¶: config/config.yaml, ç½‘ç«™æ•°: 2
2026/01/23 15:30:01 [INFO] Sitemapè§£æå®Œæˆ - URL: https://example.com/sitemap.xml, æ‰¾åˆ° 1250 ä¸ªURL
2026/01/23 15:30:01 [INFO] å¼€å§‹æäº¤ - ç½‘ç«™: example.com, å¹³å°: baidu, URLæ•°é‡: 100
2026/01/23 15:30:05 [SUCCESS] æäº¤å®Œæˆ - ç½‘ç«™: example.com, å¹³å°: baidu, æˆåŠŸ: 98
```

## ğŸ”‘ è·å–APIå¯†é’¥

### ç™¾åº¦ç«™é•¿å¹³å°

1. è®¿é—® [ç™¾åº¦ç«™é•¿å¹³å°](https://ziyuan.baidu.com/)
2. æ·»åŠ å¹¶éªŒè¯ä½ çš„ç½‘ç«™
3. è¿›å…¥"æ™®é€šæ”¶å½•" -> "APIæäº¤"
4. å¤åˆ¶æ¥å£è°ƒç”¨åœ°å€ä¸­çš„tokenå‚æ•°

### Bing IndexNow

1. è®¿é—® [Bing Webmaster Tools](https://www.bing.com/webmasters)
2. æ·»åŠ å¹¶éªŒè¯ä½ çš„ç½‘ç«™
3. ç”ŸæˆIndexNow APIå¯†é’¥
4. åœ¨ç½‘ç«™æ ¹ç›®å½•åˆ›å»º `{api-key}.txt` æ–‡ä»¶ï¼ˆå†…å®¹ä¸ºAPIå¯†é’¥ï¼‰

### Google (IndexNow)

ç›®å‰Googleå°šæœªæ­£å¼æ”¯æŒIndexNowåè®®ï¼Œä½†ä¿ç•™äº†é…ç½®æ¥å£ä»¥ä¾¿æœªæ¥ä½¿ç”¨ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
submit-sitemap/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ submit-sitemap/      # ä¸»ç¨‹åº
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ config/              # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ sitemap/             # Sitemapè§£æå™¨
â”‚   â”œâ”€â”€ history/             # å†å²è®°å½•ç®¡ç†
â”‚   â”œâ”€â”€ logger/              # æ—¥å¿—ç³»ç»Ÿ
â”‚   â””â”€â”€ submitter/           # æœç´¢å¼•æ“æäº¤å™¨
â”œâ”€â”€ pkg/
â”‚   â””â”€â”€ types/               # å…¬å…±ç±»å‹å®šä¹‰
â”œâ”€â”€ config/
â”‚   â””â”€â”€ sites/               # ç«™ç‚¹é…ç½®ç›®å½•ï¼ˆæ–°æ¶æ„ï¼‰
â”‚       â”œâ”€â”€ kebenwang.cn/    # ç¤ºä¾‹ï¼šè¯¾æœ¬ç½‘é…ç½®
â”‚       â”‚   â””â”€â”€ site.yaml
â”‚       â”œâ”€â”€ example.com/     # ç¤ºä¾‹ï¼šå…¶ä»–ç½‘ç«™é…ç½®
â”‚       â”‚   â””â”€â”€ site.yaml
â”‚       â”œâ”€â”€ _template/       # é…ç½®æ¨¡æ¿
â”‚       â”‚   â””â”€â”€ site.yaml.example
â”‚       â””â”€â”€ README.md        # é…ç½®è¯´æ˜
â”œâ”€â”€ data/                    # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ submitted/           # å·²æäº¤URLè®°å½•
â”‚   â”‚   â””â”€â”€ example.com/
â”‚   â”‚       â”œâ”€â”€ baidu.txt
â”‚   â”‚       â”œâ”€â”€ bing.txt
â”‚   â”‚       â””â”€â”€ google.txt
â”‚   â””â”€â”€ logs/                # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ dist/                    # ç¼–è¯‘è¾“å‡ºç›®å½•
â”‚   â””â”€â”€ submit              # å¯æ‰§è¡Œæ–‡ä»¶
â”œâ”€â”€ docs/                    # æ–‡æ¡£
â”‚   â””â”€â”€ CONFIG_MIGRATION.md  # é…ç½®è¿ç§»æŒ‡å—
â””â”€â”€ submit-sitemap           # å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆæ ¹ç›®å½•ï¼‰
```

## âš™ï¸ é…ç½®è¯´æ˜

### ç½‘ç«™é…ç½®

- `name`: ç½‘ç«™åç§°ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨domainï¼‰
- `domain`: ç½‘ç«™åŸŸå
- `sitemap_url`: Sitemap URLï¼ˆæ”¯æŒsitemap.xmlã€sitemap_index.xmlã€.gzå‹ç¼©æ–‡ä»¶ï¼‰

### é…é¢é…ç½®

- `baidu`: æ¯å¤©æäº¤åˆ°ç™¾åº¦çš„URLæ•°é‡
- `bing`: æ¯å¤©æäº¤åˆ°Bingçš„URLæ•°é‡
- `google`: æ¯å¤©æäº¤åˆ°Googleçš„URLæ•°é‡

è®¾ç½®ä¸º0è¡¨ç¤ºä¸æäº¤åˆ°è¯¥å¹³å°ã€‚

### å…¨å±€è®¾ç½®

```yaml
settings:
  sitemap_cache_hours: 168  # Sitemapç¼“å­˜æ—¶é—´ï¼ˆå°æ—¶ï¼‰
  timeout: 30               # è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
  concurrent: 3             # å¹¶å‘æ•°
  log_level: info           # æ—¥å¿—çº§åˆ«
```

## ğŸ”„ å·¥ä½œæµç¨‹

```
1. ä»sitemapè·å–æ‰€æœ‰URL
    â†“
2. åŠ è½½å†å²è®°å½•ï¼ˆå·²æäº¤çš„URLï¼‰
    â†“
3. è¿‡æ»¤å‡ºæœªæäº¤çš„URL
    â†“
4. æ ¹æ®é…é¢é™åˆ¶é€‰æ‹©è¦æäº¤çš„URL
    â†“
5. æäº¤åˆ°å„ä¸ªæœç´¢å¼•æ“
    â†“
6. ä¿å­˜æˆåŠŸæäº¤çš„URLåˆ°å†å²è®°å½•
```

## ğŸ’¡ æœ€ä½³å®è·µ

### å®šæ—¶ä»»åŠ¡

ä½¿ç”¨crontabè®¾ç½®æ¯å¤©è‡ªåŠ¨è¿è¡Œï¼š

```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©æ—©ä¸Š9ç‚¹è¿è¡Œï¼‰
0 9 * * * cd /path/to/submit-sitemap && ./dist/submit run >> data/logs/cron.log 2>&1
```

### é…é¢å»ºè®®

- **ç™¾åº¦**: æ™®é€šç«™ç‚¹æ¯æ—¥é…é¢500æ¡ï¼Œæ–°ç«™3000æ¡
- **Bing**: IndexNowæ²¡æœ‰ä¸¥æ ¼é™åˆ¶ï¼Œå»ºè®®200-500æ¡/å¤©
- **Google**: ç›®å‰ä¸æ”¯æŒï¼Œå¯è®¾ä¸º0

### å¤šç«™ç‚¹ç®¡ç†

æ¯ä¸ªç½‘ç«™ä½¿ç”¨ç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ æ–°ç«™ç‚¹éå¸¸ç®€å•ï¼š

```bash
# åˆ›å»ºæ–°ç«™ç‚¹é…ç½®ç›®å½•
mkdir -p config/sites/blog.example.com

# å¤åˆ¶æ¨¡æ¿
cp config/sites/_template/site.yaml.example config/sites/blog.example.com/site.yaml

# ç¼–è¾‘é…ç½®
vim config/sites/blog.example.com/site.yaml
```

ç¨‹åºè¿è¡Œæ—¶ä¼šè‡ªåŠ¨å‘ç°å¹¶åŠ è½½æ‰€æœ‰ç«™ç‚¹é…ç½®ï¼š

```bash
./dist/submit run
# ğŸ“‚ é…ç½®ç›®å½•: /path/to/config/sites
# ğŸ“ åŠ è½½äº† 2 ä¸ªç«™ç‚¹é…ç½®
# ğŸ“¦ å¤„ç†ç½‘ç«™ [1/2]: ä¸»ç«™ (example.com)
# ğŸ“¦ å¤„ç†ç½‘ç«™ [2/2]: åšå®¢ (blog.example.com)
```

> **æç¤º**ï¼šæŸ¥çœ‹ [é…ç½®è¿ç§»æŒ‡å—](docs/CONFIG_MIGRATION.md) äº†è§£ä»æ—§ç‰ˆæœ¬é…ç½®è¿ç§»çš„è¯¦ç»†æ­¥éª¤ã€‚

## ğŸ› æ•…éšœæ’é™¤

### Sitemapè·å–å¤±è´¥

- æ£€æŸ¥sitemap URLæ˜¯å¦æ­£ç¡®
- ç¡®è®¤ç½‘ç«™å¯ä»¥æ­£å¸¸è®¿é—®
- æ£€æŸ¥sitemapæ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®

### æäº¤å¤±è´¥

- éªŒè¯APIå¯†é’¥æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç«™åŸŸåé…ç½®æ˜¯å¦åŒ¹é…
- æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯

### å†å²è®°å½•é—®é¢˜

å¦‚éœ€é‡æ–°æäº¤æ‰€æœ‰URLï¼Œå¯ä»¥æ¸…é™¤å†å²è®°å½•ï¼š

```bash
./dist/submit reset example.com
```

## ğŸ“ å¼€å‘è¯´æ˜

### ä¾èµ–åŒ…

```bash
go get gopkg.in/yaml.v3
```

### ç¼–è¯‘

**ä½¿ç”¨æ„å»ºè„šæœ¬ï¼ˆæ¨èï¼‰**

```bash
# ä¸€é”®æ„å»º macOS æ‰€æœ‰ç‰ˆæœ¬
./build.sh
```

æ„å»ºè„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- æ¸…ç†æ—§çš„æ„å»ºæ–‡ä»¶
- æ„å»º Intel Mac ç‰ˆæœ¬ (amd64)
- æ„å»º Apple Silicon ç‰ˆæœ¬ (arm64)
- æ„å»ºå½“å‰å¹³å°é€šç”¨ç‰ˆæœ¬
- æ˜¾ç¤ºè¯¦ç»†çš„æ„å»ºä¿¡æ¯

**æ‰‹åŠ¨ç¼–è¯‘**

```bash
# å½“å‰å¹³å°
go build -o submit-sitemap ./cmd/submit-sitemap

# macOS Intel
GOOS=darwin GOARCH=amd64 go build -o submit-sitemap-darwin-amd64 ./cmd/submit-sitemap

# macOS Apple Silicon
GOOS=darwin GOARCH=arm64 go build -o submit-sitemap-darwin-arm64 ./cmd/submit-sitemap

# Linux
GOOS=linux GOARCH=amd64 go build -o submit-sitemap-linux ./cmd/submit-sitemap

# Windows
GOOS=windows GOARCH=amd64 go build -o submit-sitemap.exe ./cmd/submit-sitemap
```

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **APIå¯†é’¥å®‰å…¨**: ä¸è¦å°†åŒ…å«APIå¯†é’¥çš„é…ç½®æ–‡ä»¶æäº¤åˆ°å…¬å¼€ä»“åº“
2. **é…é¢é™åˆ¶**: éµå®ˆå„å¹³å°çš„é…é¢é™åˆ¶ï¼Œé¿å…è¿‡åº¦æäº¤
3. **Sitemapæ›´æ–°**: å»ºè®®æ¯å‘¨æ›´æ–°ä¸€æ¬¡sitemapï¼Œé…ç½®çš„ç¼“å­˜æ—¶é—´ä¸º7å¤©
4. **å¤±è´¥URL**: æäº¤å¤±è´¥çš„URLä¸ä¼šé‡è¯•ï¼Œä¸‹æ¬¡è¿è¡Œæ—¶ä¼šå†æ¬¡å°è¯•æäº¤
